on: [push]

jobs:
    run_tests:
        name: Run tests
        runs-on: ubuntu-latest
        services:
            postgres:
                image: mdillon/postgis:11
                ports:
                    - '5432:5432'
                env:
                    POSTGRES_PASSWORD: postgres
                    POSTGRES_DB: panther
        steps:
            - uses: actions/checkout@v2
            - uses: actions/setup-node@v2.1.4
              with:
                  node-version: '12.x'
            - run: 'npm ci'
            - run: 'npm run start &'
            - run: 'npm run test:wait'
